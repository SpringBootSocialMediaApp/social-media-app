<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friends - SocialHub</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@2.51.5/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand': {
                            500: '#10B981'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar styling */
        .scroll-container::-webkit-scrollbar {
            width: 8px;
        }

        .scroll-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .scroll-container::-webkit-scrollbar-thumb {
            background: #c5c5c5;
            border-radius: 4px;
        }

        .scroll-container::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .friend-card {
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #ffffff, #f8fafc);
        }

        .friend-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 35px -10px rgba(0, 0, 0, 0.15);
        }

        /* Scrollbar for main content */
        .scroll-container {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e0 #f1f5f9;
        }

        /* Modern smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Enhanced border radius for modern look */
        .modern-card {
            border-radius: 16px;
        }

        /* Gradient background for online status */
        .online-indicator {
            background: linear-gradient(45deg, #10b981, #34d399);
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);
        }

        /* Mobile responsive adjustments */
        @media (max-width: 768px) {
            .w-64 {
                width: 100%;
                position: relative !important;
                height: auto !important;
                padding-top: 0 !important;
            }

            .ml-64 {
                margin-left: 0 !important;
            }

            .mt-16 {
                margin-top: 0 !important;
            }

            .flex-1.overflow-y-auto {
                margin-top: 1rem !important;
            }
        }

        /* Enhanced focus states for accessibility */
        input:focus, select:focus, button:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* Loading animation for images */
        img {
            transition: opacity 0.3s ease;
        }

        img:not([src]) {
            opacity: 0;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
<!-- Include the navbar component -->
<div th:replace="components/navbar :: navbar" class="z-10"></div>

<div class="flex flex-1 overflow-hidden">
    <!-- Left Sidebar -->
    <div class="w-64 bg-white shadow-lg border-r border-gray-200 h-screen fixed left-0 top-0 pt-16 flex flex-col z-20">
        <div class="p-6 border-b border-gray-200">
            <h1 class="text-2xl font-bold text-gray-800 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
                Friends
            </h1>
        </div>

        <!-- Navigation Menu -->
        <nav class="p-4">
            <ul class="space-y-2">
                <li>
                    <button onclick="showSection('all-friends')"
                            class="nav-item w-full flex items-center px-4 py-3 text-left rounded-lg hover:bg-gray-100 transition-colors active bg-blue-50 text-blue-600">
                        <svg xmlns="http://www.w3.org/2000/svg" class="mr-3 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        All Friends
                        <span class="ml-auto bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs">127</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('friend-requests')"
                            class="nav-item w-full flex items-center px-4 py-3 text-left rounded-lg hover:bg-gray-100 transition-colors text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="mr-3 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                        </svg>
                        Friend Requests
                        <span class="ml-auto bg-red-100 text-red-600 px-2 py-1 rounded-full text-xs">3</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('sent-requests')"
                            class="nav-item w-full flex items-center px-4 py-3 text-left rounded-lg hover:bg-gray-100 transition-colors text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="mr-3 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                        </svg>
                        Sent Requests
                        <span class="ml-auto bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">5</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('user-directory')"
                            class="nav-item w-full flex items-center px-4 py-3 text-left rounded-lg hover:bg-gray-100 transition-colors text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="mr-3 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        Find Friends
                    </button>
                </li>
            </ul>
        </nav>

        <!-- Online Friends Section -->
        <div class="mt-auto p-4 border-t border-gray-200">
            <h3 class="font-semibold text-gray-700 mb-3">Online Now</h3>
            <div class="flex items-center space-x-3 mb-3">
                <div class="relative">
                    <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face"
                         class="w-10 h-10 rounded-full object-cover" alt="John">
                    <span class="online-indicator absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white"></span>
                </div>
                <span class="text-sm font-medium">John</span>
            </div>
            <div class="flex items-center space-x-3">
                <div class="relative">
                    <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=40&h=40&fit=crop&crop=face"
                         class="w-10 h-10 rounded-full object-cover" alt="Mike">
                    <span class="online-indicator absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white"></span>
                </div>
                <span class="text-sm font-medium">Mike</span>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="flex-1 overflow-y-auto scroll-container ml-64">
        <!-- All Friends Section -->
        <div id="all-friends" class="content-section">
            <div class="bg-white border-b border-gray-200 p-6 sticky top-0 z-30 shadow-sm">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">All Friends</h2>
                <div class="flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-4">
                    <div class="relative w-full md:max-w-md">
                        <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <input type="text" placeholder="Search friends..."
                               class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                    </div>
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-full md:w-auto transition-all duration-200">
                        <option>All Friends</option>
                        <option>Recently Added</option>
                        <option>Online</option>
                        <option>Mutual Friends</option>
                    </select>
                </div>
            </div>

            <div class="p-6">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Friend Cards -->
                    <div class="friend-card modern-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="relative">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face"
                                 alt="Profile" class="w-full h-48 object-cover">
                            <div class="absolute top-3 right-3">
                                <span class="online-indicator w-4 h-4 rounded-full border-2 border-white"></span>
                            </div>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800 mb-1">John Doe</h3>
                            <p class="text-sm text-gray-600 mb-3">15 mutual friends</p>
                            <div class="flex space-x-2">
                                <button class="btn-primary flex-1 text-white py-2 px-3 rounded-lg text-sm font-medium">
                                    Message
                                </button>
                                <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:border-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card modern-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="relative">
                            <img src="https://images.unsplash.com/photo-1494790108755-2616b612b8c5?w=150&h=150&fit=crop&crop=face"
                                 alt="Profile" class="w-full h-48 object-cover">
                            <div class="absolute top-3 right-3">
                                <span class="w-4 h-4 bg-gray-400 rounded-full border-2 border-white"></span>
                            </div>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800 mb-1">Sarah Wilson</h3>
                            <p class="text-sm text-gray-600 mb-3">8 mutual friends</p>
                            <div class="flex space-x-2">
                                <button class="btn-primary flex-1 text-white py-2 px-3 rounded-lg text-sm font-medium">
                                    Message
                                </button>
                                <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:border-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card modern-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="relative">
                            <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face"
                                 alt="Profile" class="w-full h-48 object-cover">
                            <div class="absolute top-3 right-3">
                                <span class="online-indicator w-4 h-4 rounded-full border-2 border-white"></span>
                            </div>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800 mb-1">Mike Johnson</h3>
                            <p class="text-sm text-gray-600 mb-3">22 mutual friends</p>
                            <div class="flex space-x-2">
                                <button class="btn-primary flex-1 text-white py-2 px-3 rounded-lg text-sm font-medium">
                                    Message
                                </button>
                                <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:border-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card modern-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="relative">
                            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face"
                                 alt="Profile" class="w-full h-48 object-cover">
                            <div class="absolute top-3 right-3">
                                <span class="w-4 h-4 bg-gray-400 rounded-full border-2 border-white"></span>
                            </div>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800 mb-1">Alex Chen</h3>
                            <p class="text-sm text-gray-600 mb-3">5 mutual friends</p>
                            <div class="flex space-x-2">
                                <button class="btn-primary flex-1 text-white py-2 px-3 rounded-lg text-sm font-medium">
                                    Message
                                </button>
                                <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:border-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card modern-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="relative">
                            <img src="https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?w=150&h=150&fit=crop&crop=face"
                                 alt="Profile" class="w-full h-48 object-cover">
                            <div class="absolute top-3 right-3">
                                <span class="online-indicator w-4 h-4 rounded-full border-2 border-white"></span>
                            </div>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800 mb-1">Ryan Martinez</h3>
                            <p class="text-sm text-gray-600 mb-3">3 mutual friends</p>
                            <div class="flex space-x-2">
                                <button class="btn-primary flex-1 text-white py-2 px-3 rounded-lg text-sm font-medium">
                                    Message
                                </button>
                                <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:border-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card modern-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="relative">
                            <img src="https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?w=150&h=150&fit=crop&crop=face"
                                 alt="Profile" class="w-full h-48 object-cover">
                            <div class="absolute top-3 right-3">
                                <span class="w-4 h-4 bg-gray-400 rounded-full border-2 border-white"></span>
                            </div>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800 mb-1">Jessica Brown</h3>
                            <p class="text-sm text-gray-600 mb-3">7 mutual friends</p>
                            <div class="flex space-x-2">
                                <button class="btn-primary flex-1 text-white py-2 px-3 rounded-lg text-sm font-medium">
                                    Message
                                </button>
                                <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:border-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="mt-8 flex justify-center">
                    <div class="flex space-x-2">
                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50" disabled>
                            Previous
                        </button>
                        <button class="px-3 py-2 bg-blue-600 text-white rounded-lg">1</button>
                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">2</button>
                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">3</button>
                        <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Friend Requests Section -->
        <div id="friend-requests" class="content-section hidden">
            <div class="bg-white border-b border-gray-200 p-6 sticky top-0 z-30 shadow-sm">
                <h2 class="text-xl font-semibold text-gray-800">Friend Requests</h2>
                <p class="text-gray-600 mt-1">People who want to connect with you</p>
            </div>

            <div class="p-6">
                <div class="space-y-4">
                    <!-- Friend Request Cards -->
                    <div class="friend-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-4">
                            <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=60&h=60&fit=crop&crop=face"
                                 alt="Profile" class="w-16 h-16 rounded-full object-cover">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-800">Alex Chen</h3>
                                <p class="text-sm text-gray-600">5 mutual friends</p>
                                <p class="text-xs text-gray-500 mt-1">2 days ago</p>
                            </div>
                            <div class="flex space-x-3">
                                <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                    Accept
                                </button>
                                <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                                    Decline
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-4">
                            <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=60&h=60&fit=crop&crop=face"
                                 alt="Profile" class="w-16 h-16 rounded-full object-cover">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-800">Emma Davis</h3>
                                <p class="text-sm text-gray-600">12 mutual friends</p>
                                <p class="text-xs text-gray-500 mt-1">1 week ago</p>
                            </div>
                            <div class="flex space-x-3">
                                <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                    Accept
                                </button>
                                <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                                    Decline
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-4">
                            <img src="https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?w=60&h=60&fit=crop&crop=face"
                                 alt="Profile" class="w-16 h-16 rounded-full object-cover">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-800">Ryan Martinez</h3>
                                <p class="text-sm text-gray-600">3 mutual friends</p>
                                <p class="text-xs text-gray-500 mt-1">3 days ago</p>
                            </div>
                            <div class="flex space-x-3">
                                <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                    Accept
                                </button>
                                <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                                    Decline
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sent Requests Section -->
        <div id="sent-requests" class="content-section hidden">
            <div class="bg-white border-b border-gray-200 p-6 sticky top-0 z-30 shadow-sm">
                <h2 class="text-xl font-semibold text-gray-800">Sent Requests</h2>
                <p class="text-gray-600 mt-1">Friend requests you've sent</p>
            </div>

            <div class="p-6">
                <div class="space-y-4">
                    <!-- Sent Request Cards -->
                    <div class="friend-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-4">
                            <img src="https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?w=60&h=60&fit=crop&crop=face"
                                 alt="Profile" class="w-16 h-16 rounded-full object-cover">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-800">Jessica Brown</h3>
                                <p class="text-sm text-gray-600">7 mutual friends</p>
                                <p class="text-xs text-gray-500 mt-1">Sent 1 day ago</p>
                            </div>
                            <div class="flex space-x-3">
                                <button class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                                    Cancel Request
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="friend-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-center space-x-4">
                            <img src="https://images.unsplash.com/photo-1566492031773-4f4e44671d66?w=60&h=60&fit=crop&crop=face"
                                 alt="Profile" class="w-16 h-16 rounded-full object-cover">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-800">David Kim</h3>
                                <p class="text-sm text-gray-600">2 mutual friends</p>
                                <p class="text-xs text-gray-500 mt-1">Sent 3 days ago</p>
                            </div>
                            <div class="flex space-x-3">
                                <button class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                                    Cancel Request
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Directory Section -->
        <div id="user-directory" class="content-section hidden">
            <div class="bg-white border-b border-gray-200 p-6 sticky top-0 z-30 shadow-sm">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Find Friends</h2>
                <div class="flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-4">
                    <div class="relative w-full md:max-w-md">
                        <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <input type="text" placeholder="Search people..."
                               class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                    </div>
                    <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors w-full md:w-auto">
                        Search
                    </button>
                </div>
            </div>

            <div class="p-6">
                <div id="user-directory-cards" class="space-y-4">
                    <!-- User Directory Cards will be populated dynamically -->
                    <div id="loading-users" class="flex justify-center items-center py-8">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                        <span class="ml-3 text-gray-600">Loading users...</span>
                    </div>
                </div>

                <!-- Pagination -->
                <div id="user-directory-pagination" class="mt-8 flex justify-center hidden">
                    <div class="flex space-x-2">
                        <button id="prev-page" class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50" disabled>
                            Previous
                        </button>
                        <div id="page-numbers" class="flex space-x-2">
                            <!-- Page numbers will be populated dynamically -->
                        </div>
                        <button id="next-page" class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Global variables for user directory
    let currentPage = 0;
    let totalPages = 0;
    let currentUserId = null; // Will be loaded dynamically

    // Function to get current user ID
    async function getCurrentUserId() {
        try {
            const response = await fetch('/api/users/current');
            if (response.ok) {
                const user = await response.json();
                return user.id;
            }
        } catch (error) {
            console.error('Error fetching current user:', error);
        }
        return null;
    }

    // Function to get random profile image based on gender
    function getRandomProfileImage(gender, id) {
        const maleImages = [
            'photo-1472099645785-5658abf4ff4e',
            'photo-1500648767791-00dcc994a43e',
            'photo-1507003211169-0a1dd7228f2d',
            'photo-1570295999919-56ceb5ecca61',
            'photo-1519244703995-f4e0f30006d5',
            'photo-1566492031773-4f4e44671d66'
        ];

        const femaleImages = [
            'photo-1494790108755-2616b612b8c5',
            'photo-1544725176-7c40e5a71c5e',
            'photo-1438761681033-6461ffad8d80',
            'photo-1487412720507-e7ab37603c6f',
            'photo-1527980965255-d3b416303d12'
        ];

        const images = gender === 'female' ? femaleImages : maleImages;
        const selectedImage = images[id % images.length];
        return `https://images.unsplash.com/${selectedImage}?w=60&h=60&fit=crop&crop=face`;
    }

    // Function to create user card HTML
    function createUserCard(user) {
        const fullName = `${user.firstName} ${user.lastName}`;
        const profileImage = getRandomProfileImage(user.gender, user.id);
        const mutualFriends = Math.floor(Math.random() * 10) + 1; // Random number for now

        return `
            <div class="friend-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow">
                <div class="flex items-center space-x-4">
                    <img src="${profileImage}" alt="Profile" class="w-16 h-16 rounded-full object-cover">
                    <div class="flex-1">
                        <h3 class="font-semibold text-gray-800">${fullName}</h3>
                        <p class="text-sm text-gray-600">${user.email}</p>
                        <p class="text-xs text-gray-500 mt-1">${mutualFriends} mutual friends</p>
                    </div>
                    <div class="flex space-x-3">
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
                                onclick="addFriend(${user.id})">
                            Add Friend
                        </button>
                        <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors"
                                onclick="viewProfile(${user.id})">
                            View Profile
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    // Function to fetch users from API
    async function fetchUsers(page = 0, size = 5) {
        try {
            const response = await fetch(`/api/users?currentUserId=${currentUserId}&page=${page}&size=${size}`);

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            return data;
        } catch (error) {
            console.error('Error fetching users:', error);
            return null;
        }
    }

    // Function to display users in the UI
    function displayUsers(users) {
        const container = document.getElementById('user-directory-cards');
        const loadingDiv = document.getElementById('loading-users');

        if (loadingDiv) {
            loadingDiv.style.display = 'none';
        }

        if (!users || users.length === 0) {
            container.innerHTML = `
                <div class="text-center py-8">
                    <div class="text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <p class="text-lg font-medium">No users found</p>
                        <p class="text-sm">Try adjusting your search criteria</p>
                    </div>
                </div>
            `;
            return;
        }

        container.innerHTML = users.map(user => createUserCard(user)).join('');
    }

    // Function to update pagination
    function updatePagination(pageData) {
        const paginationDiv = document.getElementById('user-directory-pagination');
        const pageNumbersDiv = document.getElementById('page-numbers');
        const prevButton = document.getElementById('prev-page');
        const nextButton = document.getElementById('next-page');

        currentPage = pageData.number;
        totalPages = pageData.totalPages;

        if (totalPages <= 1) {
            paginationDiv.classList.add('hidden');
            return;
        }

        paginationDiv.classList.remove('hidden');

        // Update previous button
        prevButton.disabled = pageData.first;

        // Update next button
        nextButton.disabled = pageData.last;

        // Generate page numbers
        pageNumbersDiv.innerHTML = '';
        for (let i = 0; i < totalPages; i++) {
            const pageButton = document.createElement('button');
            pageButton.className = i === currentPage ?
                'px-3 py-2 bg-blue-600 text-white rounded-lg' :
                'px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50';
            pageButton.textContent = i + 1;
            pageButton.onclick = () => loadUsersPage(i);
            pageNumbersDiv.appendChild(pageButton);
        }
    }

    // Function to load users for a specific page
    async function loadUsersPage(page) {
        const loadingDiv = document.getElementById('loading-users');
        if (loadingDiv) {
            loadingDiv.style.display = 'flex';
        }

        // Get current user ID if not already loaded
        if (currentUserId === null) {
            currentUserId = await getCurrentUserId();
            if (currentUserId === null) {
                console.error('Could not get current user ID');
                return;
            }
        }

        const data = await fetchUsers(page, 5);

        if (data) {
            displayUsers(data.content);
            updatePagination(data);
        } else {
            // Handle error case
            const container = document.getElementById('user-directory-cards');
            container.innerHTML = `
                <div class="text-center py-8">
                    <div class="text-red-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <p class="text-lg font-medium">Error loading users</p>
                        <p class="text-sm">Please check your connection and try again</p>
                        <button onclick="loadUsersPage(0)" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            Retry
                        </button>
                    </div>
                </div>
            `;
        }
    }

    // Function to handle search
    async function searchUsers(searchTerm) {
        if (searchTerm.trim() === '') {
            loadUsersPage(0);
            return;
        }

        // For now, we'll filter the current results
        // You might want to implement server-side search later
        const cards = document.querySelectorAll('#user-directory-cards .friend-card');
        cards.forEach(card => {
            const nameElement = card.querySelector('h3');
            if (nameElement) {
                const name = nameElement.textContent.toLowerCase();
                if (name.includes(searchTerm.toLowerCase())) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            }
        });
    }

    // Functions for user actions
    function addFriend(userId) {
        // You can implement the actual API call here
        console.log('Adding friend with ID:', userId);

        // For now, just update the button text
        const button = event.target;
        button.textContent = 'Request Sent';
        button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
        button.classList.add('bg-gray-400', 'cursor-not-allowed');
        button.disabled = true;
    }

    function viewProfile(userId) {
        // You can implement profile viewing here
        console.log('Viewing profile for user ID:', userId);
        // For example: window.location.href = `/profile/${userId}`;
    }

    // Update existing navigation functionality
    function showSection(sectionId) {
        // Hide all sections
        const sections = document.querySelectorAll('.content-section');
        sections.forEach(section => section.classList.add('hidden'));

        // Show selected section
        document.getElementById(sectionId).classList.remove('hidden');

        // Update navigation active state
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.classList.remove('active', 'bg-blue-50', 'text-blue-600');
            item.classList.add('text-gray-700');
        });

        // Set active nav item
        event.target.classList.add('active', 'bg-blue-50', 'text-blue-600');
        event.target.classList.remove('text-gray-700');

        // Load users when user-directory section is shown
        if (sectionId === 'user-directory') {
            loadUsersPage(0);
        }
    }

    // Friend request actions
    document.addEventListener('click', function(e) {
        if (e.target.textContent === 'Accept') {
            e.target.textContent = 'Accepted';
            e.target.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            e.target.classList.add('bg-green-600', 'hover:bg-green-700');

            // Hide decline button
            const declineBtn = e.target.nextElementSibling;
            if (declineBtn) declineBtn.style.display = 'none';
        }

        if (e.target.textContent === 'Decline') {
            e.target.closest('.bg-white').style.display = 'none';
        }

        if (e.target.textContent === 'Cancel Request') {
            e.target.closest('.bg-white').style.display = 'none';
        }

        // Handle Add Friend buttons that don't have onclick handlers (legacy)
        if (e.target.textContent === 'Add Friend' && !e.target.hasAttribute('onclick')) {
            e.target.textContent = 'Request Sent';
            e.target.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            e.target.classList.add('bg-gray-400', 'cursor-not-allowed');
            e.target.disabled = true;
        }
    });

    // Search functionality
    document.addEventListener('input', function(e) {
        if (e.target.placeholder.includes('Search')) {
            const searchTerm = e.target.value.toLowerCase();

            // Check if we're in the user directory section
            const userDirectorySection = document.getElementById('user-directory');
            if (!userDirectorySection.classList.contains('hidden')) {
                // Handle user directory search
                searchUsers(searchTerm);
            } else {
                // Handle regular friend search
                const cards = document.querySelectorAll('.friend-card');
                cards.forEach(card => {
                    const nameElement = card.querySelector('h3');
                    if (nameElement) {
                        const name = nameElement.textContent.toLowerCase();
                        if (name.includes(searchTerm)) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    }
                });
            }
        }
    });

    // Pagination event listeners
    document.addEventListener('DOMContentLoaded', function() {
        // Previous page button
        document.getElementById('prev-page').addEventListener('click', function() {
            if (currentPage > 0) {
                loadUsersPage(currentPage - 1);
            }
        });

        // Next page button
        document.getElementById('next-page').addEventListener('click', function() {
            if (currentPage < totalPages - 1) {
                loadUsersPage(currentPage + 1);
            }
        });

        // Initialize the page with the first section active
        showSection('all-friends');
    });
</script>
</body>
</html>